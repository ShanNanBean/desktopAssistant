<Window x:Class="PowerShellHelper.Views.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:PowerShellHelper.ViewModels"
        Title="设置" 
        Height="500" Width="700"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">
    
    <Window.DataContext>
        <vm:SettingsWindowViewModel/>
    </Window.DataContext>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 设置内容 -->
        <TabControl Grid.Row="0" Margin="10">
            <!-- AI模型配置 -->
            <TabItem Header="AI模型配置">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="20">
                        <TextBlock Text="模型提供商" FontWeight="Bold" Margin="0,0,0,5"/>
                        <ComboBox ItemsSource="{Binding AIProviders}"
                                 SelectedItem="{Binding SelectedProvider}"
                                 Margin="0,0,0,15"
                                 Padding="8"/>

                        <TextBlock Text="API密钥" FontWeight="Bold" Margin="0,0,0,5"/>
                        <PasswordBox x:Name="ApiKeyBox" 
                                    Margin="0,0,0,5"
                                    Padding="8"/>
                        <TextBlock Text="请妥善保管您的API密钥" 
                                  FontSize="11" 
                                  Foreground="#666"
                                  Margin="0,0,0,15"/>

                        <TextBlock Text="API端点(可选)" FontWeight="Bold" Margin="0,0,0,5"/>
                        <TextBox Text="{Binding ApiEndpoint, UpdateSourceTrigger=PropertyChanged}"
                                Margin="0,0,0,5"/>
                        <TextBlock Text="留空将使用默认端点" 
                                  FontSize="11" 
                                  Foreground="#666"
                                  Margin="0,0,0,15"/>

                        <TextBlock Text="模型名称(可选)" FontWeight="Bold" Margin="0,0,0,5"/>
                        <TextBox Text="{Binding ModelName, UpdateSourceTrigger=PropertyChanged}"
                                Margin="0,0,0,5"/>
                        <TextBlock Text="留空将使用默认模型" 
                                  FontSize="11" 
                                  Foreground="#666"
                                  Margin="0,0,0,15"/>

                        <TextBlock Text="请求超时时间(秒)" FontWeight="Bold" Margin="0,0,0,5"/>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                            <Slider x:Name="TimeoutSlider"
                                   Value="{Binding TimeoutSeconds}"
                                   Minimum="30"
                                   Maximum="180"
                                   TickFrequency="10"
                                   IsSnapToTickEnabled="True"
                                   Width="400"
                                   VerticalAlignment="Center"/>
                            <TextBlock Text="{Binding TimeoutSeconds}"
                                      FontSize="14"
                                      FontWeight="Bold"
                                      Margin="10,0,0,0"
                                      VerticalAlignment="Center"/>
                            <TextBlock Text="秒"
                                      FontSize="14"
                                      Margin="3,0,0,0"
                                      VerticalAlignment="Center"/>
                        </StackPanel>
                        <TextBlock Text="复杂任务(如生成Word文档)建议设置90秒以上" 
                                  FontSize="11" 
                                  Foreground="#666"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- 安全策略 -->
            <TabItem Header="安全策略">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="20">
                        <TextBlock Text="安全级别" FontWeight="Bold" Margin="0,0,0,10"/>
                        
                        <RadioButton GroupName="SecurityLevel" 
                                    IsChecked="{Binding SecurityLevel, Converter={StaticResource EnumToBoolConverter}, ConverterParameter=Strict}"
                                    Margin="0,5">
                            <StackPanel>
                                <TextBlock Text="严格模式" FontWeight="Bold"/>
                                <TextBlock Text="仅允许只读查询命令,适合新手用户" 
                                          FontSize="11" 
                                          Foreground="#666"
                                          TextWrapping="Wrap"
                                          Margin="0,2,0,0"/>
                            </StackPanel>
                        </RadioButton>

                        <RadioButton GroupName="SecurityLevel" 
                                    IsChecked="{Binding SecurityLevel, Converter={StaticResource EnumToBoolConverter}, ConverterParameter=Standard}"
                                    Margin="0,10">
                            <StackPanel>
                                <TextBlock Text="标准模式" FontWeight="Bold"/>
                                <TextBlock Text="允许文件和网络操作,但需要确认" 
                                          FontSize="11" 
                                          Foreground="#666"
                                          TextWrapping="Wrap"
                                          Margin="0,2,0,0"/>
                            </StackPanel>
                        </RadioButton>

                        <RadioButton GroupName="SecurityLevel" 
                                    IsChecked="{Binding SecurityLevel, Converter={StaticResource EnumToBoolConverter}, ConverterParameter=Relaxed}"
                                    Margin="0,10">
                            <StackPanel>
                                <TextBlock Text="宽松模式" FontWeight="Bold"/>
                                <TextBlock Text="允许大部分操作,仅拦截极危险命令" 
                                          FontSize="11" 
                                          Foreground="#666"
                                          TextWrapping="Wrap"
                                          Margin="0,2,0,0"/>
                            </StackPanel>
                        </RadioButton>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- 界面配置 -->
            <TabItem Header="界面配置">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="20">
                        <TextBlock Text="默认编辑器" FontWeight="Bold" Margin="0,0,0,5"/>
                        <ComboBox ItemsSource="{Binding AvailableEditors}"
                                 SelectedValue="{Binding DefaultEditor}"
                                 SelectedValuePath="Path"
                                 DisplayMemberPath="Name"
                                 Margin="0,0,0,15"
                                 Padding="8"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- 关于 -->
            <TabItem Header="关于">
                <StackPanel Margin="20" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock Text="PowerShell 桌面助手" 
                              FontSize="20" 
                              FontWeight="Bold"
                              HorizontalAlignment="Center"
                              Margin="0,0,0,10"/>
                    <TextBlock Text="版本 1.0.0" 
                              FontSize="14"
                              HorizontalAlignment="Center"
                              Foreground="#666"
                              Margin="0,0,0,20"/>
                    <TextBlock Text="通过自然语言对话生成PowerShell命令" 
                              FontSize="12"
                              HorizontalAlignment="Center"
                              Foreground="#666"
                              Margin="0,0,0,5"/>
                    <TextBlock Text="让Windows命令操作更加简单高效" 
                              FontSize="12"
                              HorizontalAlignment="Center"
                              Foreground="#666"/>
                </StackPanel>
            </TabItem>
        </TabControl>

        <!-- 底部按钮 -->
        <Border Grid.Row="1" 
               Background="#F5F5F5" 
               BorderBrush="#E0E0E0"
               BorderThickness="0,1,0,0"
               Padding="20,15">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="恢复默认" 
                       Command="{Binding ResetCommand}"
                       Margin="0,0,10,0"
                       Padding="15,8"
                       Background="#757575"/>
                <Button Content="取消" 
                       Command="{Binding CancelCommand}"
                       Margin="0,0,10,0"
                       Padding="15,8"
                       Background="#757575"/>
                <Button Content="保存" 
                       Command="{Binding SaveCommand}"
                       Padding="15,8"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>
